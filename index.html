<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Resume Releases</title>
  <style>
    :root{--bg:#0b0d10;--card:#11151b;--fg:#e7edf3;--muted:#9aa4b2;--accent:#4c8bf5;--ok:#19c37d}
    *{box-sizing:border-box} html,body{margin:0;background:var(--bg);color:var(--fg);font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial}
    header{padding:18px;border-bottom:1px solid #1c212b;background:linear-gradient(180deg,#0b0d10,#0c1117)}
    h1{margin:0;font-size:18px}
    main{max-width:960px;margin:0 auto;padding:18px;display:grid;gap:14px}
    .card{background:var(--card);border:1px solid #1c212b;border-radius:12px;padding:14px}
    .muted{color:var(--muted)}
    a{color:var(--accent);text-decoration:none}
    .row{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .badge{display:inline-flex;align-items:center;gap:6px;border:1px solid #253044;border-radius:999px;padding:4px 10px;color:#b9cff5}
    .score{font-weight:700}
    ul{list-style:none;margin:0;padding:0}
    li{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:10px 0;border-bottom:1px dashed #1f2633}
    li:last-child{border-bottom:0}
    .links{display:flex;align-items:center;gap:16px}
  </style>
</head>
<body>
  <header>
    <h1>Resume Releases <span class="muted">· versions & live latest</span></h1>
  </header>
  <main>
    <section class="card">
      <div class="row">
        <div>
          <div class="muted">Latest</div>
          <div id="latestSha">—</div>
        </div>
        <div class="links">
          <a id="latestPdf" href="latest/resume.pdf">Open Latest PDF</a>
          <a id="latestReport" href="latest/ats-pro-report.html">Report</a>
        </div>
      </div>
    </section>

    <section class="card">
      <div class="row" style="margin-bottom:8px;">
        <div><strong>Versions</strong></div>
        <div class="muted">Newest first</div>
      </div>
      <ul id="versions"></ul>
    </section>
  </main>

  <script>
  async function load() {
    try {
      const r = await fetch('gh.json', { cache: 'no-cache' });
      if (!r.ok) throw new Error('gh.json not found');
      const data = await r.json();
      document.getElementById('latestSha').textContent = data.latest || '—';

      // Latest links are static paths (point to /latest/)
      document.getElementById('latestPdf').href = 'latest/resume.pdf';
      document.getElementById('latestReport').href = 'latest/ats-pro-report.html';

      const list = document.getElementById('versions');
      list.innerHTML = '';
      const versions = (data.versions || []).slice().sort((a,b)=> (a.tag < b.tag ? 1 : -1));
      for (const v of versions) {
        const score = (v.score == null || v.score === 'null') ? '—' : v.score;
        const li = document.createElement('li');
        li.innerHTML = `
          <div><code>${v.tag}</code></div>
          <div class="links">
            <span class="badge">Score <span class="score">${score}</span></span>
            <a href="versions/${v.tag}/resume.pdf">PDF</a>
            <a href="versions/${v.tag}/ats-pro-report.html">Report</a>
          </div>
        `;
        list.appendChild(li);
      }
    } catch (e) {
      console.error(e);
      document.querySelector('main').insertAdjacentHTML('beforeend',
        '<div class="card"><div class="muted">No release metadata found.</div><div>Publish the main branch to generate <code>gh.json</code>.</div></div>'
      );
    }
  }
  load();
  </script>
</body>
</html>
